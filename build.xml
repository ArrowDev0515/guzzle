<?xml version="1.0" encoding="UTF-8"?>

<project name="guzzle" default="init">

    <!-- ============================================  -->
    <!-- Target: init-git                              -->
    <!-- ============================================  -->
    <target name="init-git">
        <echo msg="Initializing git submodules" />
        <exec command="git submodule init" />
        <exec command="git submodule update" />
    </target>

    <!-- ============================================  -->
    <!-- Target: init-test                             -->
    <!-- ============================================  -->
    <target name="init-test">
        <echo msg="Copying ./phpunit.xml.dist to ./phpunit.xml" />
        <copy file="./phpunit.xml.dist" tofile="./phpunit.xml" />
    </target>

    <!-- ============================================  -->
    <!-- (DEFAULT)  Target: init                       -->
    <!-- ============================================  -->
    <target name="init" depends="init-git,init-test" />

    <!-- ============================================  -->
    <!-- Target: phar                                  -->
    <!-- ============================================  -->
    <target name="phar">
        <pharpackage destfile="./guzzle.phar" basedir="./src" compression="gzip">
            <fileset dir="./src">
                <include name="**/**" />
            </fileset>
            <metadata>
                <element name="version" value="1.0" />
                <element name="authors">
                    <element name="Michael Dowling">
                        <element name="e-mail" value="michael@guzzlephp.org" />
                    </element>
                </element>
            </metadata>
        </pharpackage>
    </target>

</project>